package com.trustmubaiwa.dvtweatherproject.repository

import com.google.gson.Gson
import com.nhaarman.mockitokotlin2.any
import com.nhaarman.mockitokotlin2.whenever
import com.trustmubaiwa.dvtweatherproject.common.DataState
import com.trustmubaiwa.dvtweatherproject.services.WeatherService
import com.trustmubaiwa.dvtweatherproject.services.models.CurrentWeatherResponse
import com.trustmubaiwa.dvtweatherproject.services.models.ForecastWeatherResponse
import junit.framework.TestCase
import kotlinx.coroutines.flow.first
import kotlinx.coroutines.flow.take
import kotlinx.coroutines.flow.toList
import kotlinx.coroutines.runBlocking
import org.junit.Before
import org.junit.Test
import org.mockito.Mock
import org.mockito.MockitoAnnotations
import retrofit2.Response


class WeatherRepositoryTest : TestCase() {

    lateinit var repository: WeatherRepository

    @Mock
    lateinit var mockService: WeatherService

    @Before
    override fun setUp() {
        super.setUp()
        MockitoAnnotations.initMocks(this)

        repository = WeatherRepository(mockService)
    }

    @Test
    fun `test fetchCurrentWeather should emit loading state as the first result`() = runBlocking {
        val long: Float = 12.1.toFloat()
        val lat: Float = 12.1.toFloat()

        val result = repository.fetchCurrentWeather(lat, long)

        assertEquals(DataState.Loading, result.first())
    }

    @Test
    fun `test fetchCurrentWeather should return emit success with DataState Success when service call is successful`() = runBlocking {
        val long: Float = 12.1.toFloat()
        val lat: Float = 12.1.toFloat()
        val response = successfulResult()

        whenever(mockService.getCurrentWeather(any(), any(), any())).thenReturn(response)

        val result = repository.fetchCurrentWeather(lat, long)
        val r = result.take(2).toList()

//        assertEquals(2, result.count())
        assertEquals(DataState.Success(response), r[2])
//        assertEquals(DataState.Success(response), result.count)
//        assertEquals(DataState.Success(response), result.drop(1).first())

    }

    @Test
    fun `test fetchWeatherForecast should return the forecast weather object when fetch is successful`() = runBlocking {
        val long: Float = 12.1.toFloat()
        val lat: Float = 12.1.toFloat()
        val response = successfulForecastResult()

        whenever(mockService.getWeatherForecast(any(), any(), any())).thenReturn(response)

        val result = repository.fetchWeatherForecast(lat, long)

        assertEquals(response.body(), result)
    }

    private fun successfulResult(): Response<CurrentWeatherResponse> {
        val responseString =
            """{"coord":{"lon":27.9483,"lat":26.3008},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"base":"stations","main":{"temp":301.83,"feels_like":300.57,"temp_min":301.83,"temp_max":301.83,"pressure":1009,"humidity":26,"sea_level":1009,"grnd_level":967},"visibility":10000,"wind":{"speed":5.29,"deg":5,"gust":9.63},"clouds":{"all":0},"dt":1627155207,"sys":{"country":"EG","sunrise":1627097367,"sunset":1627145979},"timezone":7200,"id":350661,"name":"Qaşr al Farāfirah","cod":200}"""
        val serialisedResult = Gson().fromJson(responseString, CurrentWeatherResponse::class.java)
        return Response.success(serialisedResult)
    }

    private fun successfulForecastResult(): Response<ForecastWeatherResponse> {
        val responseString =
            """{"cod":"200","message":0,"cnt":40,"list":[{"dt":1627786800,"main":{"temp":281.14,"feels_like":281.14,"temp_min":281.14,"temp_max":282.3,"pressure":1029,"sea_level":1029,"grnd_level":855,"humidity":31,"temp_kf":-1.16},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.71,"deg":219,"gust":0.72},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-01 03:00:00"},{"dt":1627797600,"main":{"temp":282.08,"feels_like":282.08,"temp_min":282.08,"temp_max":283.97,"pressure":1029,"sea_level":1029,"grnd_level":857,"humidity":29,"temp_kf":-1.89},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":0.84,"deg":221,"gust":1.03},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-01 06:00:00"},{"dt":1627808400,"main":{"temp":286.69,"feels_like":284.65,"temp_min":286.69,"temp_max":289.47,"pressure":1029,"sea_level":1029,"grnd_level":859,"humidity":21,"temp_kf":-2.78},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.19,"deg":251,"gust":3.08},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-01 09:00:00"},{"dt":1627819200,"main":{"temp":292.89,"feels_like":291.21,"temp_min":292.89,"temp_max":292.89,"pressure":1024,"sea_level":1024,"grnd_level":857,"humidity":11,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.94,"deg":222,"gust":4.34},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-01 12:00:00"},{"dt":1627830000,"main":{"temp":292.53,"feels_like":290.81,"temp_min":292.53,"temp_max":292.53,"pressure":1022,"sea_level":1022,"grnd_level":855,"humidity":11,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":3.29,"deg":217,"gust":4.9},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-01 15:00:00"},{"dt":1627840800,"main":{"temp":288.09,"feels_like":286.06,"temp_min":288.09,"temp_max":288.09,"pressure":1025,"sea_level":1025,"grnd_level":855,"humidity":16,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.91,"deg":182,"gust":6.3},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-01 18:00:00"},{"dt":1627851600,"main":{"temp":285.95,"feels_like":283.78,"temp_min":285.95,"temp_max":285.95,"pressure":1026,"sea_level":1026,"grnd_level":855,"humidity":19,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":12},"wind":{"speed":2.61,"deg":190,"gust":6.56},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-01 21:00:00"},{"dt":1627862400,"main":{"temp":284.3,"feels_like":282.1,"temp_min":284.3,"temp_max":284.3,"pressure":1025,"sea_level":1025,"grnd_level":853,"humidity":24,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":12},"wind":{"speed":2.67,"deg":190,"gust":7.38},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-02 00:00:00"},{"dt":1627873200,"main":{"temp":282.8,"feels_like":281.22,"temp_min":282.8,"temp_max":282.8,"pressure":1024,"sea_level":1024,"grnd_level":852,"humidity":27,"temp_kf":0},"weather":[{"id":801,"main":"Clouds","description":"few clouds","icon":"02n"}],"clouds":{"all":15},"wind":{"speed":3.04,"deg":187,"gust":8.36},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-02 03:00:00"},{"dt":1627884000,"main":{"temp":284.18,"feels_like":281.94,"temp_min":284.18,"temp_max":284.18,"pressure":1025,"sea_level":1025,"grnd_level":853,"humidity":23,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":7},"wind":{"speed":4.04,"deg":182,"gust":11.82},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-02 06:00:00"},{"dt":1627894800,"main":{"temp":291.2,"feels_like":289.37,"temp_min":291.2,"temp_max":291.2,"pressure":1024,"sea_level":1024,"grnd_level":856,"humidity":12,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":4.74,"deg":124,"gust":7.66},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-02 09:00:00"},{"dt":1627905600,"main":{"temp":295.76,"feels_like":294.26,"temp_min":295.76,"temp_max":295.76,"pressure":1020,"sea_level":1020,"grnd_level":855,"humidity":7,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":4.86,"deg":53,"gust":6.2},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-02 12:00:00"},{"dt":1627916400,"main":{"temp":292.99,"feels_like":291.26,"temp_min":292.99,"temp_max":292.99,"pressure":1021,"sea_level":1021,"grnd_level":855,"humidity":9,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":5.24,"deg":30,"gust":7.15},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-02 15:00:00"},{"dt":1627927200,"main":{"temp":288.27,"feels_like":286.18,"temp_min":288.27,"temp_max":288.27,"pressure":1024,"sea_level":1024,"grnd_level":855,"humidity":13,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.41,"deg":40,"gust":6.12},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-02 18:00:00"},{"dt":1627938000,"main":{"temp":284.83,"feels_like":282.92,"temp_min":284.83,"temp_max":284.83,"pressure":1027,"sea_level":1027,"grnd_level":855,"humidity":33,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.32,"deg":63,"gust":8.06},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-02 21:00:00"},{"dt":1627948800,"main":{"temp":283.18,"feels_like":281.67,"temp_min":283.18,"temp_max":283.18,"pressure":1027,"sea_level":1027,"grnd_level":854,"humidity":55,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":3.07,"deg":64,"gust":8.29},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-03 00:00:00"},{"dt":1627959600,"main":{"temp":281.86,"feels_like":280.66,"temp_min":281.86,"temp_max":281.86,"pressure":1027,"sea_level":1027,"grnd_level":853,"humidity":67,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":2.22,"deg":42,"gust":6.7},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-03 03:00:00"},{"dt":1627970400,"main":{"temp":282.71,"feels_like":281.26,"temp_min":282.71,"temp_max":282.71,"pressure":1029,"sea_level":1029,"grnd_level":856,"humidity":66,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.79,"deg":17,"gust":7.12},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-03 06:00:00"},{"dt":1627981200,"main":{"temp":287.86,"feels_like":286.51,"temp_min":287.86,"temp_max":287.86,"pressure":1029,"sea_level":1029,"grnd_level":858,"humidity":43,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":4.38,"deg":355,"gust":5.76},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-03 09:00:00"},{"dt":1627992000,"main":{"temp":290.88,"feels_like":289.49,"temp_min":290.88,"temp_max":290.88,"pressure":1025,"sea_level":1025,"grnd_level":856,"humidity":30,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":3.66,"deg":337,"gust":3.79},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-03 12:00:00"},{"dt":1628002800,"main":{"temp":290.56,"feels_like":289.06,"temp_min":290.56,"temp_max":290.56,"pressure":1024,"sea_level":1024,"grnd_level":856,"humidity":27,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.87,"deg":327,"gust":2.98},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-03 15:00:00"},{"dt":1628013600,"main":{"temp":286.76,"feels_like":285.06,"temp_min":286.76,"temp_max":286.76,"pressure":1027,"sea_level":1027,"grnd_level":856,"humidity":34,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.13,"deg":279,"gust":2.54},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-03 18:00:00"},{"dt":1628024400,"main":{"temp":285.47,"feels_like":283.72,"temp_min":285.47,"temp_max":285.47,"pressure":1026,"sea_level":1026,"grnd_level":855,"humidity":37,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.27,"deg":24,"gust":1.65},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-03 21:00:00"},{"dt":1628035200,"main":{"temp":283.67,"feels_like":281.95,"temp_min":283.67,"temp_max":283.67,"pressure":1026,"sea_level":1026,"grnd_level":854,"humidity":45,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.94,"deg":357,"gust":1.26},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-04 00:00:00"},{"dt":1628046000,"main":{"temp":282.58,"feels_like":282.58,"temp_min":282.58,"temp_max":282.58,"pressure":1027,"sea_level":1027,"grnd_level":854,"humidity":54,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.97,"deg":14,"gust":1.32},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-04 03:00:00"},{"dt":1628056800,"main":{"temp":284.15,"feels_like":282.61,"temp_min":284.15,"temp_max":284.15,"pressure":1028,"sea_level":1028,"grnd_level":856,"humidity":50,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":0.24,"deg":15,"gust":0.79},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-04 06:00:00"},{"dt":1628067600,"main":{"temp":289.58,"feels_like":288.17,"temp_min":289.58,"temp_max":289.58,"pressure":1027,"sea_level":1027,"grnd_level":857,"humidity":34,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":0.93,"deg":350,"gust":0.7},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-04 09:00:00"},{"dt":1628078400,"main":{"temp":292.52,"feels_like":291.06,"temp_min":292.52,"temp_max":292.52,"pressure":1023,"sea_level":1023,"grnd_level":856,"humidity":21,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":0.57,"deg":255,"gust":0.96},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-04 12:00:00"},{"dt":1628089200,"main":{"temp":292.19,"feels_like":290.65,"temp_min":292.19,"temp_max":292.19,"pressure":1022,"sea_level":1022,"grnd_level":855,"humidity":19,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":0.4,"deg":231,"gust":1.02},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-04 15:00:00"},{"dt":1628100000,"main":{"temp":288.17,"feels_like":286.46,"temp_min":288.17,"temp_max":288.17,"pressure":1024,"sea_level":1024,"grnd_level":854,"humidity":28,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.47,"deg":328,"gust":2.24},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-04 18:00:00"},{"dt":1628110800,"main":{"temp":286.42,"feels_like":284.72,"temp_min":286.42,"temp_max":286.42,"pressure":1025,"sea_level":1025,"grnd_level":854,"humidity":35,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.24,"deg":310,"gust":0.5},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-04 21:00:00"},{"dt":1628121600,"main":{"temp":285.27,"feels_like":283.5,"temp_min":285.27,"temp_max":285.27,"pressure":1024,"sea_level":1024,"grnd_level":853,"humidity":37,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":0.78,"deg":4,"gust":0.9},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-05 00:00:00"},{"dt":1628132400,"main":{"temp":283.77,"feels_like":281.98,"temp_min":283.77,"temp_max":283.77,"pressure":1025,"sea_level":1025,"grnd_level":853,"humidity":42,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.11,"deg":15,"gust":1.27},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-05 03:00:00"},{"dt":1628143200,"main":{"temp":285.26,"feels_like":283.49,"temp_min":285.26,"temp_max":285.26,"pressure":1026,"sea_level":1026,"grnd_level":855,"humidity":37,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.02,"deg":10,"gust":2},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-05 06:00:00"},{"dt":1628154000,"main":{"temp":290.72,"feels_like":289.21,"temp_min":290.72,"temp_max":290.72,"pressure":1024,"sea_level":1024,"grnd_level":856,"humidity":26,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.38,"deg":337,"gust":2.47},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-05 09:00:00"},{"dt":1628164800,"main":{"temp":293.94,"feels_like":292.54,"temp_min":293.94,"temp_max":293.94,"pressure":1021,"sea_level":1021,"grnd_level":855,"humidity":18,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.28,"deg":320,"gust":2.33},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-05 12:00:00"},{"dt":1628175600,"main":{"temp":293.79,"feels_like":292.41,"temp_min":293.79,"temp_max":293.79,"pressure":1020,"sea_level":1020,"grnd_level":854,"humidity":19,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":2.24,"deg":306,"gust":2.87},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-05 15:00:00"},{"dt":1628186400,"main":{"temp":289.15,"feels_like":287.56,"temp_min":289.15,"temp_max":289.15,"pressure":1022,"sea_level":1022,"grnd_level":854,"humidity":29,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.83,"deg":313,"gust":3.8},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-05 18:00:00"},{"dt":1628197200,"main":{"temp":287.63,"feels_like":285.97,"temp_min":287.63,"temp_max":287.63,"pressure":1023,"sea_level":1023,"grnd_level":853,"humidity":32,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01n"}],"clouds":{"all":0},"wind":{"speed":1.25,"deg":303,"gust":2.01},"visibility":10000,"pop":0,"sys":{"pod":"n"},"dt_txt":"2021-08-05 21:00:00"},{"dt":1628208000,"main":{"temp":286.44,"feels_like":284.74,"temp_min":286.44,"temp_max":286.44,"pressure":1022,"sea_level":1022,"grnd_level":852,"humidity":35,"temp_kf":0},"weather":[{"id":800,"main":"Clear","description":"clear sky","icon":"01d"}],"clouds":{"all":0},"wind":{"speed":1.25,"deg":291,"gust":1.69},"visibility":10000,"pop":0,"sys":{"pod":"d"},"dt_txt":"2021-08-06 00:00:00"}],"city":{"id":1005265,"name":"Erand","coord":{"lat":-25.9721,"lon":28.1215},"country":"ZA","population":0,"timezone":7200,"sunrise":1627793174,"sunset":1627832478}}"""
        val serialisedResult = Gson().fromJson(responseString, ForecastWeatherResponse::class.java)
        return Response.success(serialisedResult)
    }
}
